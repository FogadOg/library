<div class="grid grid-cols-6 gap-6">
  <% @books.each do |book| %>
    <div
      class="card col-span-6 lg:col-span-3 shadow-xl relative lg:cursor-default cursor-pointer"
      data-book-id="<%= book.id %>"
    >
      <div class="md:hidden" data-action="click->book-review#open"></div>
      <div class="card-body">
        <div class="flex space-x-5">
          <div class="w-2/7 md:w-1/6">
            <img src="<%= book.cover_image_url %>" alt="<%= book.title %> book cover" class="rounded-xl">
          </div>
          <div class="w-5/7 md:w-5/6">
            <div class="h-2/4">
              <div class="flex">
                <h3 class="font-semibold text-lg md:text-xl w-7/8"><%= book.title %></h3>
                <div class="w-1/8">
                  <% if current_user.bookmarks.exists?(book: book) %>
                    <%= form_with(url: book_bookmarks_path(book), method: :delete, class: 'bookmark-form', data: { book_id: book.id }, local: false) do |f| %>
                      <button type="submit" class="btn p-2 shadow-xl bg-[#FC674E] rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="white" class="bi bi-bookmark-fill" viewBox="0 0 16 16">
                          <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z"/>
                        </svg>
                      </button>
                    <% end %>
                  <% else %>
                    <%= form_with(url: book_bookmarks_path(book), method: :post, class: 'bookmark-form', data: { book_id: book.id }, local: false) do |f| %>
                      <button type="submit" class="btn p-2 shadow-xl fill-[#BDBDBD] bg-white rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#BDBDBD" class="bi bi-bookmark-plus" viewBox="0 0 16 16">
                          <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l5.26 2.87A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.26-2.342a.5.5 0 0 1 .484 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
                          <path d="M6 8a.5.5 0 0 0 .5.5h1.5V10a.5.5 0 0 0 1 0V8.5H10a.5.5 0 0 0 0-1H8.5V5.5a.5.5 0 0 0-1 0V7H5.5A.5.5 0 0 0 6 8z"/>
                        </svg>
                      </button>
                    <% end %>
                  <% end %>
                </div>
              </div>
              <div class="w-7/8 flex justify-center items-center space-x-2 text-xs">
                <p>Added by <span class="font-semibold"><%= book.user.first_name %> <%= book.user.last_name %></span></p>
              </div>
              <p class="mt-3 text-xs"><%= book.description.truncate(100) %></p>
            </div>
            <div class="h-3/4 lg:h-1/4 space-x-2 flex items-center align-center">
              <span class="text-lg md:text-xl font-semibold">
                <%= (book.reviews.average(:rating) || 0).round(0.5) %>
              </span>
              <div class="rating rating-xs">
                <% 5.times do |i| %>
                  <input disabled type="radio" name="rating-<%= book.id %>" class="mask mask-star-2 bg-orange-400" <%= 'checked' if (book.reviews.average(:rating) || 0) > i %> aria-label="<%= i + 1 %> star">
                <% end %>
              </div>  
              <span class="hidden md:block">(<%= book.reviews.count %> Reviews)</span>
            </div>
            <div class="space-x-4 h-1/4 lg:flex hidden items-end">
              <label for="review-drawer" 
                  class="btn py-6 rounded-xl btn-outline text-[#111F4D] border-[#E5E5E7] cursor-pointer"
                  data-book-id="<%= book.id %>"
                  data-action="click->book-review#open"
              >
                Review
              </label>
              <button class="btn py-6 rounded-xl bg-[#111F4D] text-white">Read</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
